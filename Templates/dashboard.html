{% extends "base.html" %}

{% block title %}Dashboard - TaskNest{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-5">
        <div class="col-12">
            <div class="hero-section text-center">
                <h1 class="hero-title">
                    <i class="bi bi-speedometer2 text-honey"></i> Dashboard
                </h1>
                <p class="hero-subtitle">Welcome back, <span class="text-gradient">{{ current_user.full_name or current_user.username }}</span>! Here's your productivity overview üêù</p>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row g-4 mb-4">
        <div class="col-md-3">
            <div class="stat-card text-center fade-in">
                <i class="bi bi-list-task stat-icon"></i>
                <div class="stat-number">{{ total_tasks }}</div>
                <p class="text-muted mb-0">Total Tasks</p>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stat-card text-center fade-in" style="animation-delay: 0.1s;">
                <i class="bi bi-check-circle-fill stat-icon" style="color: var(--success-green);"></i>
                <div class="stat-number">{{ completed_tasks }}</div>
                <p class="text-muted mb-0">Completed</p>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stat-card text-center fade-in" style="animation-delay: 0.2s;">
                <i class="bi bi-clock-fill stat-icon" style="color: var(--warning-orange);"></i>
                <div class="stat-number">{{ pending_tasks }}</div>
                <p class="text-muted mb-0">Pending</p>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stat-card text-center fade-in" style="animation-delay: 0.3s;">
                <i class="bi bi-graph-up-arrow stat-icon" style="color: var(--success-green);"></i>
                <div class="stat-number">{{ completion_rate }}%</div>
                <p class="text-muted mb-0">Completion Rate</p>
            </div>
        </div>
    </div>
    
    <!-- Progress Bar -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="honeycomb-card p-4">
                <h5 class="fw-bold mb-3">
                    <i class="bi bi-trophy-fill text-honey"></i> Overall Progress
                </h5>
                <div class="progress progress-honey">
                    <div class="progress-bar progress-bar-honey" role="progressbar" 
                         style="width: {{ completion_rate }}%;" 
                         aria-valuenow="{{ completion_rate }}" 
                         aria-valuemin="0" 
                         aria-valuemax="100">
                        {{ completion_rate }}%
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row g-4">
        <!-- Upcoming Tasks -->
        <div class="col-md-6">
            <div class="honeycomb-card p-4 h-100">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="fw-bold mb-0">
                        <i class="bi bi-calendar-check text-honey"></i> Upcoming Tasks
                    </h5>
                    <a href="{{ url_for('tasks') }}" class="btn btn-sm btn-honey">View All</a>
                </div>
                
                {% if upcoming_tasks %}
                    {% for task in upcoming_tasks %}
                    <div class="task-card priority-{{ task.priority }}">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h6 class="fw-bold mb-1">{{ task.title }}</h6>
                                <p class="text-muted small mb-2">{{ task.description[:50] }}...</p>
                                <div class="d-flex gap-2">
                                    <span class="badge badge-priority-{{ task.priority }}">
                                        {{ task.priority.upper() }}
                                    </span>
                                    <span class="badge bg-secondary">{{ task.category }}</span>
                                    <span class="badge bg-info">
                                        <i class="bi bi-clock"></i> {{ task.days_remaining() }} days
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center py-4">
                        <i class="bi bi-check-circle" style="font-size: 3rem; color: var(--honey-yellow);"></i>
                        <p class="text-muted mt-2">No upcoming tasks! You're all caught up! üéâ</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Overdue Tasks & Reminders -->
        <div class="col-md-6">
            <!-- Overdue Tasks -->
            {% if overdue_tasks %}
            <div class="honeycomb-card p-4 mb-4" style="border-color: var(--danger-red);">
                <h5 class="fw-bold mb-3">
                    <i class="bi bi-exclamation-triangle-fill" style="color: var(--danger-red);"></i> Overdue Tasks
                </h5>
                
                {% for task in overdue_tasks %}
                <div class="task-card priority-high">
                    <h6 class="fw-bold mb-1">{{ task.title }}</h6>
                    <p class="text-danger small mb-2">
                        <i class="bi bi-calendar-x"></i> Due: {{ task.deadline.strftime('%b %d, %Y') }}
                    </p>
                    <a href="{{ url_for('edit_task', task_id=task.id) }}" class="btn btn-sm btn-outline-danger">
                        Update Task
                    </a>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Upcoming Reminders -->
            <div class="honeycomb-card p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="fw-bold mb-0">
                        <i class="bi bi-bell-fill text-honey"></i> Upcoming Reminders
                    </h5>
                    <a href="{{ url_for('reminders') }}" class="btn btn-sm btn-honey">View All</a>
                </div>
                
                {% if upcoming_reminders %}
                    {% for reminder in upcoming_reminders %}
                    <div class="alert alert-warning mb-2">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <strong>{{ reminder.title }}</strong>
                                <p class="mb-0 small">{{ reminder.message }}</p>
                                <small class="text-muted">
                                    <i class="bi bi-clock"></i> {{ reminder.reminder_time.strftime('%b %d, %Y %I:%M %p') }}
                                </small>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center py-4">
                        <i class="bi bi-bell-slash" style="font-size: 3rem; color: var(--honey-yellow);"></i>
                        <p class="text-muted mt-2">No upcoming reminders</p>
                        <a href="{{ url_for('new_reminder') }}" class="btn btn-sm btn-honey">
                            <i class="bi bi-plus-circle"></i> Add Reminder
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="honeycomb-card p-4">
                <h5 class="fw-bold mb-3">
                    <i class="bi bi-lightning-charge-fill text-honey"></i> Quick Actions
                </h5>
                <div class="d-flex gap-3 flex-wrap">
                    <a href="{{ url_for('new_task') }}" class="btn btn-honey">
                        <i class="bi bi-plus-circle"></i> New Task
                    </a>
                    <a href="{{ url_for('new_reminder') }}" class="btn btn-honey">
                        <i class="bi bi-bell"></i> Set Reminder
                    </a>
                    <a href="{{ url_for('calendar') }}" class="btn btn-honey">
                        <i class="bi bi-calendar3"></i> View Calendar
                    </a>
                    <a href="{{ url_for('tasks') }}" class="btn btn-honey">
                        <i class="bi bi-list-check"></i> All Tasks
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
